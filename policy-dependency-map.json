{
  "timestamp": "2025-10-07T19:19:35.837Z",
  "summary": {
    "totalTables": 24,
    "totalFunctions": 19,
    "totalCircularReferences": 0,
    "criticalIssues": 0
  },
  "circularReferences": [],
  "dependencyMap": {
    "nodes": [
      {
        "id": "profiles",
        "type": "table",
        "label": "profiles\n(9 policies)",
        "policyCount": 9,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "customers",
        "type": "table",
        "label": "customers\n(17 policies)",
        "policyCount": 17,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "services",
        "type": "table",
        "label": "services\n(7 policies)",
        "policyCount": 7,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "jobs",
        "type": "table",
        "label": "jobs\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "quotes",
        "type": "table",
        "label": "quotes\n(13 policies)",
        "policyCount": 13,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "invoices",
        "type": "table",
        "label": "invoices\n(12 policies)",
        "policyCount": 12,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "settings",
        "type": "table",
        "label": "settings\n(7 policies)",
        "policyCount": 7,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "quote_responses",
        "type": "table",
        "label": "quote_responses\n(3 policies)",
        "policyCount": 3,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "user_permissions",
        "type": "table",
        "label": "user_permissions\n(6 policies)",
        "policyCount": 6,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "job_series",
        "type": "table",
        "label": "job_series\n(7 policies)",
        "policyCount": 7,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "job_occurrences",
        "type": "table",
        "label": "job_occurrences\n(7 policies)",
        "policyCount": 7,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "jobs_calendar_upcoming",
        "type": "table",
        "label": "jobs_calendar_upcoming\n(1 policies)",
        "policyCount": 1,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "shared_content_access_logs",
        "type": "table",
        "label": "shared_content_access_logs\n(3 policies)",
        "policyCount": 3,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "rate_limits",
        "type": "table",
        "label": "rate_limits\n(3 policies)",
        "policyCount": 3,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "audit_logs",
        "type": "table",
        "label": "audit_logs\n(2 policies)",
        "policyCount": 2,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "appointment_series",
        "type": "table",
        "label": "appointment_series\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "appointment_occurrences",
        "type": "table",
        "label": "appointment_occurrences\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "form_templates",
        "type": "table",
        "label": "form_templates\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "form_fields",
        "type": "table",
        "label": "form_fields\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "form_responses",
        "type": "table",
        "label": "form_responses\n(6 policies)",
        "policyCount": 6,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "form_assignments",
        "type": "table",
        "label": "form_assignments\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "clinicians",
        "type": "table",
        "label": "clinicians\n(6 policies)",
        "policyCount": 6,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "objects",
        "type": "table",
        "label": "objects\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "cliniclevel_license_types",
        "type": "table",
        "label": "cliniclevel_license_types\n(4 policies)",
        "policyCount": 4,
        "hasCircularReference": false,
        "color": "#4444ff"
      },
      {
        "id": "handle_new_user",
        "type": "function",
        "label": "handle_new_user()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "handle_user_update",
        "type": "function",
        "label": "handle_user_update()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_user_tenant_id",
        "type": "function",
        "label": "get_user_tenant_id()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "update_updated_at_column",
        "type": "function",
        "label": "update_updated_at_column()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_current_user_role",
        "type": "function",
        "label": "get_current_user_role()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "generate_quote_share_token",
        "type": "function",
        "label": "generate_quote_share_token()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_user_permissions",
        "type": "function",
        "label": "get_user_permissions()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "cleanup_expired_rate_limits",
        "type": "function",
        "label": "cleanup_expired_rate_limits()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "check_rate_limit",
        "type": "function",
        "label": "check_rate_limit()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "cleanup_expired_share_tokens",
        "type": "function",
        "label": "cleanup_expired_share_tokens()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "validate_share_token_expiration",
        "type": "function",
        "label": "validate_share_token_expiration()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_public_quote_by_token",
        "type": "function",
        "label": "get_public_quote_by_token()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_public_invoice_by_token",
        "type": "function",
        "label": "get_public_invoice_by_token()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "validate_quote_response_input",
        "type": "function",
        "label": "validate_quote_response_input()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "get_masked_customer_data",
        "type": "function",
        "label": "get_masked_customer_data()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "log_permission_changes",
        "type": "function",
        "label": "log_permission_changes()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "enhanced_rate_limit_check",
        "type": "function",
        "label": "enhanced_rate_limit_check()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "handle_client_signup",
        "type": "function",
        "label": "handle_client_signup()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      },
      {
        "id": "is_admin",
        "type": "function",
        "label": "is_admin()\n0 table refs",
        "hasCircularReference": false,
        "color": "#44ff44"
      }
    ],
    "edges": [
      {
        "from": "customers",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "services",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "jobs",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "quotes",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "quotes",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "invoices",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "invoices",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "settings",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "quote_responses",
        "to": "quotes",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "user_permissions",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "job_series",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "job_series",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "job_occurrences",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "job_occurrences",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "shared_content_access_logs",
        "to": "invoices",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "shared_content_access_logs",
        "to": "quotes",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "appointment_series",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "appointment_series",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "appointment_occurrences",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "appointment_occurrences",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_templates",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_fields",
        "to": "form_templates",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_fields",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_responses",
        "to": "form_templates",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_responses",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_responses",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_assignments",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "form_assignments",
        "to": "customers",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "clinicians",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      },
      {
        "from": "cliniclevel_license_types",
        "to": "profiles",
        "type": "table_dependency",
        "label": "depends on"
      }
    ],
    "clusters": {},
    "circularReferences": []
  },
  "mermaidDiagram": "graph TD\n    profiles[profiles]:::table\n    customers[customers]:::table\n    services[services]:::table\n    jobs[jobs]:::table\n    quotes[quotes]:::table\n    invoices[invoices]:::table\n    settings[settings]:::table\n    quote_responses[quote_responses]:::table\n    user_permissions[user_permissions]:::table\n    job_series[job_series]:::table\n    job_occurrences[job_occurrences]:::table\n    jobs_calendar_upcoming[jobs_calendar_upcoming]:::table\n    shared_content_access_logs[shared_content_access_logs]:::table\n    rate_limits[rate_limits]:::table\n    audit_logs[audit_logs]:::table\n    appointment_series[appointment_series]:::table\n    appointment_occurrences[appointment_occurrences]:::table\n    form_templates[form_templates]:::table\n    form_fields[form_fields]:::table\n    form_responses[form_responses]:::table\n    form_assignments[form_assignments]:::table\n    clinicians[clinicians]:::table\n    objects[objects]:::table\n    cliniclevel_license_types[cliniclevel_license_types]:::table\n    handle_new_user((handle_new_user)):::function\n    handle_user_update((handle_user_update)):::function\n    get_user_tenant_id((get_user_tenant_id)):::function\n    update_updated_at_column((update_updated_at_column)):::function\n    get_current_user_role((get_current_user_role)):::function\n    generate_quote_share_token((generate_quote_share_token)):::function\n    get_user_permissions((get_user_permissions)):::function\n    cleanup_expired_rate_limits((cleanup_expired_rate_limits)):::function\n    check_rate_limit((check_rate_limit)):::function\n    cleanup_expired_share_tokens((cleanup_expired_share_tokens)):::function\n    validate_share_token_expiration((validate_share_token_expiration)):::function\n    get_public_quote_by_token((get_public_quote_by_token)):::function\n    get_public_invoice_by_token((get_public_invoice_by_token)):::function\n    validate_quote_response_input((validate_quote_response_input)):::function\n    get_masked_customer_data((get_masked_customer_data)):::function\n    log_permission_changes((log_permission_changes)):::function\n    enhanced_rate_limit_check((enhanced_rate_limit_check)):::function\n    handle_client_signup((handle_client_signup)):::function\n    is_admin((is_admin)):::function\n    customers --> profiles\n    services --> profiles\n    jobs --> profiles\n    quotes --> profiles\n    quotes --> customers\n    invoices --> profiles\n    invoices --> customers\n    settings --> profiles\n    quote_responses --> quotes\n    user_permissions --> profiles\n    job_series --> profiles\n    job_series --> customers\n    job_occurrences --> profiles\n    job_occurrences --> customers\n    shared_content_access_logs --> invoices\n    shared_content_access_logs --> quotes\n    appointment_series --> customers\n    appointment_series --> profiles\n    appointment_occurrences --> customers\n    appointment_occurrences --> profiles\n    form_templates --> profiles\n    form_fields --> form_templates\n    form_fields --> profiles\n    form_responses --> form_templates\n    form_responses --> profiles\n    form_responses --> customers\n    form_assignments --> profiles\n    form_assignments --> customers\n    clinicians --> profiles\n    cliniclevel_license_types --> profiles\n\n    classDef table fill:#e1f5fe,stroke:#01579b,stroke-width:2px\n    classDef function fill:#f3e5f5,stroke:#4a148c,stroke-width:2px\n    classDef error fill:#ffebee,stroke:#b71c1c,stroke-width:3px\n",
  "detailedAnalysis": []
}